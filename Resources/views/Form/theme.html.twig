{% extends 'form_div_layout.html.twig' %}
{% import _self as macro %}
{%- block row_attributes -%}
    {%- for attrname, attrvalue in row_attr -%}
        {%- if attrname in ['placeholder', 'title'] -%}
            {{- attrname }}="{{ translation_domain is same as(false) ? attrvalue : attrvalue|trans({}, translation_domain) }}"
        {%- elseif attrvalue is same as(true) -%}
            {{- attrname }}="{{ attrname }}"
        {%- elseif attrvalue is not same as(false) -%}
            {{- attrname }}="{{ attrvalue }}"
        {%- endif -%}
    {%- endfor -%}
{%- endblock row_attributes -%}
{% block form_row -%}
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " form-group form-group-default"}) %}
{% if (not compound or force_error|default(false)) and not valid %}
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " error"}) %}
{% endif %}
{% if required -%} {% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " required"}) %}{% endif %}
    <div {{ block('row_attributes') }}>
        {{- form_label(form) -}}
        {{- form_widget(form) -}}
        {{- form_errors(form) -}}
    </div>
{%- endblock form_row %}
{% block translatable_row -%}
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " form-group"}) %}
{% if (not compound or force_error|default(false)) and not valid %}
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " error"}) %}
{% endif %}
{% if required -%} {% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " required"}) %}{% endif %}
    <div {{ block('row_attributes') }}>
        {{- form_label(form) -}}
        {{- form_widget(form) -}}
        {{- form_errors(form) -}}
    </div>
{%- endblock translatable_row %}
{% block translatable_widget %}

<ul class="nav nav-tabs nav-tabs-simple" role="tablist" data-init-reponsive-tabs="collapse">
        {% for locale in locales %}
        <li class="{% if app.request.locale == locale %}active{% endif %}">
            <a data-toggle="tab" href="#{{ attribute(form, locale).vars.unique_block_prefix }}">{{ locale|upper }}</a>
        </li>
        {% endfor %}
</ul>
<div class="tab-content">
    {% for locale in locales %}
        <div class="tab-pane {% if app.request.locale == locale %}active{% endif %}" id="{{ attribute(form, locale).vars.unique_block_prefix }}">
            <div class="row column-seperation">
            {{- form_widget(attribute(form, locale), {"required": attribute(required_options, locale)}) -}}
			{{- form_errors(attribute(form, locale)) -}}
            </div>
        </div>
   {% endfor %}
</div>
{% endblock translatable_widget %}
{% block choice_row -%}
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " form-group"}) %}
{% if (not compound or force_error|default(false)) and not valid %}
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " error"}) %}
{% endif %}
{% if required -%} {% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " required"}) %}{% endif %}
    <div {{ block('row_attributes') }}>
        {{- form_label(form) -}}
        {% set attr = attr|merge({'class': attr.class|default ~ ' ui dropdown'}) %}

        {{- form_widget(form, {'attr': attr}) -}}
        {{- form_errors(form) -}}
    </div>
{%- endblock choice_row %}
{% block date_row -%}
   <div {{ block('row_attributes') }}>
        {{- form_label(form) -}}
        {% set attr = attr|merge({'class': attr.class|default ~ ' ui dropdown'}) %}

         {{- form_widget(form, {'attr': attr}) -}}
        {{- form_errors(form) -}}
    </div>

{%- endblock date_row %}
{%- block miky_time_type_widget -%}
{% set attr = attr|merge({'class': attr.class|default ~ ' input-group bootstrap-timepicker'}) %}
    <div {{ block('widget_attributes') }}>
<input readonly type="text" {% if value is defined %} value="{{ value }}"{% endif %} name="{{ form.vars.full_name }}"class="form-control timepicker">
<span class="input-group-addon"><i class="pg-clock"></i></span>
</div>
{%- endblock miky_time_type_widget %}

{% block miky_date_time_type_row -%}
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " form-group"}) %}
{% if (not compound or force_error|default(false)) and not valid %}
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " error"}) %}
{% endif %}
{% if required -%} {% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " required"}) %}{% endif %}
    <div {{ block('row_attributes') }}>
        {{- form_label(form) -}}
        {{- form_widget(form) -}}
        {{- form_errors(form) -}}
    </div>
{%- endblock miky_date_time_type_row %}
{%- block miky_date_time_type_widget -%}
{{ form_widget(form.date, { 'attr': {'class': 'col-md-6 pull-left'} }) }}
{{ form_widget(form.time, { 'attr': {'class': 'col-md-6'} }) }}
{%- endblock miky_date_time_type_widget -%}
{%- block date_widget -%}

    {% if widget == 'single_text' %}
    <div id="" class="datepicker-component input-group date ">
<input type="text" data-locale="{{ app.request.locale }}" class="form-control"><span class="input-group-addon"><i class="fa fa-calendar"></i></span>
</div>
        {#{%- set type = type|default('text') -%}#}
        {#<div id="datepicker-component" class="input-group date col-sm-8">#}
{#<input type="text" {{ block('widget_attributes') }} {% if value is not empty %}value="{{ value }}" {% endif %} class="form-control"><span class="input-group-addon"><i class="fa fa-calendar"></i></span>#}
{#</div>#}
      {%- else -%}
        <div {{ block('widget_container_attributes') }}>
            {{- date_pattern|replace({
                '{{ year }}':  form_widget(form.year),
                '{{ month }}': form_widget(form.month),
                '{{ day }}':   form_widget(form.day),
            })|raw -}}
        </div>
    {%- endif -%}
{%- endblock date_widget -%}
{% block miky_date_type_row -%}
    {% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " form-group"}) %}
{% if (not compound or force_error|default(false)) and not valid %}
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " error"}) %}
{% endif %}
{% if required -%} {% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " required"}) %}{% endif %}
    <div {{ block('row_attributes') }}>
         {{- form_label(form) -}}
        {% set attr = attr|merge({'class': attr.class|default ~ ' ui dropdown'}) %}

            {{- form_widget(form, {'attr': attr}) -}}
        {{- form_errors(form) -}}
    </div>
{%- endblock miky_date_type_row %}
{%- block miky_date_type_widget -%}
{% set attr = attr|merge({'class': attr.class|default ~ ' datepicker-component input-group date'}) %}
    <div  {{ block('widget_attributes') }}>
<input readonly type="text" {% if value is defined %} value="{{ value }}"{% endif %} data-locale="{{ app.request.locale }}" data-format="{{ format }}" name="{{ form.vars.full_name }}" class="form-control"><span class="input-group-addon"><i class="fa fa-calendar"></i></span>
</div>
{%- endblock miky_date_type_widget -%}

{%- block textarea_widget -%}
 {% set attr = attr|merge({'class': 'form-control ' ~ (attr.class is defined ? ' ' ~ attr.class : '') ~ (errors|length > 0 ? ' error' : '')} ) %}

        <textarea style="
    width: 100%;
    height: 250px;
"{{ block('widget_attributes') }}>{{ value }}</textarea>
{%- endblock textarea_widget -%}

{%- block tinymce_widget -%}

 {% set attr = attr|merge({'class': 'form-control tinymce ' ~ (attr.class is defined ? ' ' ~ attr.class : '') ~ (errors|length > 0 ? ' error' : '')} ) %}

        <textarea style="
    width: 100%;
    height: 250px;
"{{ block('widget_attributes') }}>{{ value }}</textarea>
{%- endblock tinymce_widget -%}
{% block tinymce_row -%}
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " form-group"}) %}
{% if (not compound or force_error|default(false)) and not valid %}
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " error"}) %}
{% endif %}
{% if required -%} {% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " required"}) %}{% endif %}
    <div {{ block('row_attributes') }}>
        {{- form_label(form) -}}
        {{- form_widget(form) -}}
        {{- form_errors(form) -}}
    </div>
{%- endblock tinymce_row %}
{%- block form_widget_compound -%}

        {%- if form.parent is empty -%}
            {{ form_errors(form) }}
        {%- endif -%}
        {{- block('form_rows') -}}
        {{- form_rest(form) -}}

{%- endblock form_widget_compound -%}
{%- block form_label -%}
    {% set label_attr = label_attr|merge({'class': ''}) %}
    {% if label is not same as(false) -%}
        {% if not compound -%}
            {% set label_attr = label_attr|merge({'for': id}) %}
        {%- endif -%}

        {% if label is empty -%}
            {%- if label_format is not empty -%}
                {% set label = label_format|replace({
                '%name%': name,
                '%id%': id,
                }) %}
            {%- else -%}
                {% set label = name|humanize %}
            {%- endif -%}
        {%- endif -%}
        <label{% for attrname, attrvalue in label_attr %} {{ attrname }}="{{ attrvalue }}"{% endfor %}>{{ translation_domain is same as(false) ? label : label|trans({}, translation_domain) }}{% if required -%}
        <span class="required" aria-required="true"> * </span>
    {%- endif -%}</label>
    {%- endif -%}
{%- endblock form_label -%}
{%- block choice_widget_collapsed -%}

    {%- if required and placeholder is none and not placeholder_in_choices and not multiple and (attr.size is not defined or attr.size <= 1) -%}
        {% set required = false %}
    {%- endif -%}
    {#{% set attr = attr|merge({'class': 'form-control ' ~ (attr.class is defined ? ' ' ~ attr.class : '') ~ (errors|length > 0 ? ' error' : '')} ) %}#}
{% if simple_select == true and multiple == false %}
    {% set attr = attr|merge({'class': 'cs-select cs-skin-slide ' ~ attr.class, "data-init-plugin": "cs-select"})%}
    <select {{ block('widget_attributes') }}>
    {% else %}
    {% set attr = attr|merge({'class': 'full-width ' ~ attr.class})%}
    <select  data-init-plugin="select2" {{ block('widget_attributes') }}{% if multiple %} multiple="multiple"{% endif %}>
    {% endif %}
        {%- if placeholder is not none -%}
            <option value=""{% if required and value is empty %} selected="selected"{% endif %}>{{ placeholder != '' ? (translation_domain is same as(false) ? placeholder : placeholder|trans({}, translation_domain)) }}</option>
        {%- endif -%}
        {%- if preferred_choices|length > 0 -%}
            {% set options = preferred_choices %}
            {{- block('choice_widget_options') -}}
            {%- if choices|length > 0 and separator is not none -%}
                <option disabled="disabled">{{ separator }}</option>
            {%- endif -%}
        {%- endif -%}
        {%- set options = choices -%}
        {{- block('choice_widget_options') -}}
    </select>
{%- endblock choice_widget_collapsed -%}
{%- block tags_type_widget -%}
    {%- set type = type|default('text') -%}

        {% set attr = attr|merge({ 'class': (attr.class|default('') ~ ' tagsinput custom-tag-input')|trim }) %}

        <input type="{{ type }}" {{ block('widget_attributes') }} {% if value is not empty %}value="{{ value }}" {% endif %}/>

{%- endblock tags_type_widget -%}
{%- block form_widget_simple -%}
    {%- set type = type|default('text') -%}

        {% set attr = attr|merge({ 'class': (attr.class|default('') ~ ' form-control')|trim }) %}

        <input type="{{ type }}" {{ block('widget_attributes') }} {% if value is not empty %}value="{{ value }}" {% endif %}/>

{%- endblock form_widget_simple -%}
{%- block form_errors -%}
    {%- if errors|length > 0 -%}
        {%- for error in errors -%}
            <div class="ui red pointing label miky-validation-error">
                {{ error.message }}
            </div>
        {%- endfor -%}
    {%- endif -%}
{%- endblock form_errors -%}
{%- block checkbox_widget -%}
    <input type="checkbox" {{ block('widget_attributes') }}{% if value is defined %} value="{{ value }}"{% endif %}{% if value == true %} checked="checked"{% endif %} />
{%- endblock checkbox_widget -%}
{% block checkbox_row -%}

    <div class="form-group{% if (not compound or force_error|default(false)) and not valid %} error{% endif %}">
<div class="checkbox check-success  ">
{{- form_widget(form) -}}
        {% set label_attr = label_attr|merge({'class': 'col-md-3'}) %}
        {% if label is not same as(false) -%}
            {% if not compound -%}
                {% set label_attr = label_attr|merge({'for': id}) %}
            {%- endif -%}

            {% if label is empty -%}
                {%- if label_format is not empty -%}
                    {% set label = label_format|replace({
                    '%name%': name,
                    '%id%': id,
                    }) %}
                {%- else -%}
                    {% set label = name|humanize %}
                {%- endif -%}
            {%- endif -%}
            <label{% for attrname, attrvalue in label_attr %} {{ attrname }}="{{ attrvalue }}"{% endfor %}>{{ translation_domain is same as(false) ? label : label|trans({}, translation_domain) }}{% if required -%}
            <span class="required" aria-required="true"> * </span>
        {%- endif -%}</label>
        {%- endif -%}




    </div>
     {{- form_errors(form) -}}
    </div>
{%- endblock checkbox_row %}

{% block radio_row -%}
    <div class="field{% if (not compound or force_error|default(false)) and not valid %} error{% endif %}">
        <div class="ui radio checkbox">
            {{- form_label(form) -}}
            {{- form_widget(form) -}}
            {{- form_errors(form) -}}
        </div>
    </div>
{%- endblock radio_row %}
{% block money_row -%}
<div class="col-sm-4">
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " form-group form-group-default form-group-money input-group"}) %}
{% if (not compound or force_error|default(false)) and not valid %}
{% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " error"}) %}
{% endif %}
{% if required -%} {% set row_attr = row_attr|merge({'class': row_attr.class|default ~ " required"}) %}{% endif %}
    <div {{ block('row_attributes') }}>
        {{- form_label(form) -}}
        {{- form_widget(form) -}}
        {{- form_errors(form) -}}
    </div>
    </div>
{%- endblock money_row %}
{%- block money_widget -%}
{% set attr = attr|merge({'class': attr.class|default ~ ' form-control'}) %}
<input type="text" {% if value is defined %} value="{{ value }}"{% endif %} name="{{ form.vars.full_name }}" {{ block('widget_attributes') }}>

    <span class="input-group-addon">
{{ currency }}
</span>
{%- endblock money_widget -%}


{%- block choice_widget_expanded -%}


            {%- for child in form %}
                    <div class="checkbox col-md-3">

                        {{- form_widget(child) -}}
                        {{- form_label(child, null, {translation_domain: choice_translation_domain}) -}}
                    </div>

            {% endfor -%}
{%- endblock choice_widget_expanded -%}


{% block percent_widget -%}
    <div class="ui right labeled input">
        {{- form_widget(form) -}}
        <div class="ui basic label">%</div>
    </div>
{%- endblock percent_widget %}
{% block collection_row -%}
    <div class="{% if attr is not empty and attr.row_class is not empty %}{{ attr.row_class }}{% endif %} form-group {% if (not compound or force_error|default(false)) and not valid %} error {% endif %} {% if required -%} required{% endif %}">
        {{- form_label(form) -}}
        {{- form_widget(form) -}}
        {{- form_errors(form) -}}
    </div>
{%- endblock collection_row %}
{% block collection_widget -%}
    {% import 'MikyResourceBundle:Macros:notification.html.twig' as notification %}
    {% import _self as forms %}
    {% set attr = attr|merge({'class': attr.class|default ~ ' controls collection-widget'}) %}
    {% set formattedFullName = form.vars.full_name|replace({']': "_", '[': "_"}) %}
    {% spaceless %}
        <div data-form-type="collection" {{ block('widget_container_attributes') }}
                {% if prototype is defined and allow_add %}
                    data-prototype='{{forms.collection_item(prototype, allow_delete, button_delete_label, '__name__', formattedFullName)|e }}'
                {%- endif -%}
        >
            {{ notification.error(form.vars.errors) }}

            {% if prototypes|default is iterable %}
                {% for key, subPrototype in prototypes %}
                    <input type="hidden" data-form-prototype="{{ key }}"
                           value="{{ forms.collection_item(subPrototype, allow_delete, button_delete_label, '__name__', formattedFullName)|e }}"/>
                {% endfor %}
            {% endif %}
{% if prototype is defined and allow_add %}

                <button type="button" data-form-collection="add" class="btn btn-success"><i class="fa fa-plus" aria-hidden="true"></i> {{ button_add_label|trans }}
</button>
            {% endif %}
            <div {% if reference_property is not null %}
            data-form-reference-property="{{ reference_property }}"
            {% endif %}
             class="panel-group" id="{{ formattedFullName }}" role="tablist" aria-multiselectable="true" data-form-collection="list">
                {% for child in form %}
                    {{ forms.collection_item(child, allow_delete, button_delete_label, loop.index0, formattedFullName) }}
                {% endfor %}
            </div>


        </div>
    {% endspaceless %}
{%- endblock collection_widget %}

{% macro collection_item(form, allow_delete, button_delete_label, index, formattedFullName) %}


{% spaceless %}
<div class="panel panel-default" data-form-collection="item" data-form-collection-index="{{ index }}">
<div class="panel-heading" role="tab" id="{{ formattedFullName }}heading{{ index }}">
<h4 class="panel-title" >
<a class="collapsed" data-toggle="collapse" data-form-collection="item-title" data-parent="#{{ formattedFullName }}" href="#{{ formattedFullName }}collapse{{ index }}" aria-expanded="false" aria-controls="{{ formattedFullName }}collapse{{ index }}">
{{ index }}
</a>
</h4>
 {% if allow_delete %}
 <a href="#" class="ui labeled icon button" data-form-collection="delete">
                    <i  class="fa fa-trash" aria-hidden="true"></i>
                    {{ button_delete_label|trans }}
                    </a>
{% endif %}
</div>
<div id="{{ formattedFullName }}collapse{{ index }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="{{ formattedFullName }}heading{{ index }}">
<div class="panel-body">
 {{ form_widget(form) }}
</div>
</div>
</div>
{% endspaceless %}
{% endmacro %}

{% block miky_province_widget %}
    <div class="ui compact segment">
        <div class="inline fields">
            {{ form_row(form.code) }}
            {{ form_row(form.name) }}
            {{ form_row(form.abbreviation) }}
        </div>
    </div>
{% endblock %}

{% block miky_zone_member_widget %}
    <div class="ui compact segment">
        <div class="inline fields">
            {{ form_row(form.code) }}
        </div>
    </div>
{% endblock %}

{% block miky_promotion_rule_widget %}
    <div class="ui segment">
        {{ form_widget(form) }}
    </div>
{% endblock %}

{% block miky_promotion_action_widget %}
    <div class="ui segment">
        {{ form_widget(form) }}
    </div>
{% endblock %}


{#{% block miky_media_type_widget %}#}
    {#{{ dump(form) }}#}
    {#<div class="form-group last">#}

        {#<div class="col-md-8">#}
            {#<div class="fileinput fileinput-new" data-provides="fileinput">#}
                {#<div class="fileinput-new thumbnail" style="width: 200px; height: 150px;">#}

                    {#{% if value is not empty and value.providerReference %}#}
                        {#{% media value, 'admin' with {'class': 'img-polaroid media-object'} %}#}
                    {#{% else %}#}
                        {#<img src="http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image" alt="" />#}
                    {#{% endif %}#}
                {#</div>#}
                {#<div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px;"> </div>#}
                {#<div>#}
                                                            {#<span class="btn default btn-file">#}
                                                                {#<span class="fileinput-new"> Selectionner une image </span>#}
                                                                {#<span class="fileinput-exists">Changer d'image</span>#}
                                                                {#<input type="file"#}
                                                                {#name="{{ form.children.binaryContent.vars.full_name }}"#}
                                                                       {#id="{{ form.children.binaryContent.vars.id }}"#}
                                                                {#>#}
                                                            {#</span>#}
                    {#<span style="display: none !important;" ><input style="display: none !important;" type="checkbox" id="{{ form.children.unlink.vars.full_name }}" name="{{ form.children.unlink.vars.full_name }}" class="unlink" {% if form.children.unlink.vars.value is not empty %}value="{{ form.children.unlink.vars.value }}" {% endif %}></span>#}
                    {#<a href="javascript:;" class="btn red fileinput-exists" data-dismiss="fileinput"> Retirer </a>#}
                {#</div>#}
            {#</div>#}

        {#</div>#}
    {#</div>#}

{#{% endblock miky_media_type_widget %}#}

{% block miky_media_type_widget %}

        <div class="row">
            <div class="col-md-4 pull-left">
                {% if value is not empty and value.providerReference %}
                        <strong>{{ value.name }}</strong>
                {% endif %}
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 pull-left">
                {% if value is not empty and value.providerReference %}
                    <div class="pull-left" style="margin-right: 5px">
                        {% thumbnail value, 'admin' with {'class': 'img-polaroid media-object'} %}
                    </div>
                {% else %}
                    <div class="pull-left" style="margin-right: 5px">
                        <img src="{{ asset('bundles/sonatamedia/grey.png') }}" class="img-polaroid media-object" style="width: 85px; height: 85px"/>
                    </div>
                {% endif %}
            </div>

            <div class="col-md-2 pull-left">
                {{ block('form_widget') }}
            </div>
        </div>

{% endblock miky_media_type_widget %}